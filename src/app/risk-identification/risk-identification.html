<div class="risk-identification-container">
  <!-- Header con Logo y T√≠tulo -->
  <div class="risk-header">
    <div class="logo-section">
      <div class="logo-placeholder">Q&K</div>
    </div>
    <div class="title-section">
      <h1 class="main-title">REGISTRO DE RIESGOS Y OPORTUNIDADES DEL PORTAFOLIO DE PROYECTOS DE Q&K</h1>
    </div>
    <div class="actions-section">
      <button class="btn-add" (click)="addRisk()">
        <span>‚ûï</span> Agregar Fila
      </button>
      <button class="btn-save" (click)="guardarTodosRiesgos()">
        <span>üíæ</span> Guardar Todo
      </button>
      <button class="btn-excel" (click)="exportExcel()">
        <span>üìä</span> Excel
      </button>
      <button class="btn-pdf" (click)="exportPDF()">
        <span>üìÑ</span> PDF
      </button>
    </div>
  </div>

  <!-- Tabla Estilo Excel -->
  <div class="risks-table-wrapper">
    <table class="risks-table">
      <thead>
        <tr>
          <!-- Identificaci√≥n y An√°lisis de Riesgos -->
          <th colspan="5" class="section-header section-identificacion">Identificaci√≥n y An√°lisis de Riesgos</th>
          <!-- An√°lisis Cualitativo -->
          <th colspan="5" class="section-header section-cualitativo">An√°lisis Cualitativo</th>
          <!-- Monitoreo y Seguimiento -->
          <th colspan="8" class="section-header section-monitoreo">Monitoreo y Seguimiento</th>
          <!-- Acciones -->
          <th rowspan="2" class="col-actions">Acciones</th>
        </tr>
        <tr>
          <!-- Identificaci√≥n -->
          <th class="col-id">ID</th>
          <th class="col-tipo">Tipo</th>
          <th class="col-proyecto">ID del Proyecto</th>
          <th class="col-categoria">Categor√≠a</th>
          <th class="col-descripcion">Descripci√≥n del Riesgo</th>
          
          <!-- An√°lisis Cualitativo -->
          <th class="col-consecuencia">Consecuencia</th>
          <th class="col-identificado">Identificado por</th>
          <th class="col-fecha-registro">Fecha de Registro</th>
          <th class="col-impacto">Nivel de Impacto Total</th>
          <th class="col-probabilidad">Probabilidad de Ocurrencia</th>
          
          <!-- Monitoreo -->
          <th class="col-evaluacion">Evaluaci√≥n de Riesgos</th>
          <th class="col-estrategia">Estrategia del Riesgo</th>
          <th class="col-respuesta">Respuesta al Riesgo</th>
          <th class="col-responsable">Responsable</th>
          <th class="col-fecha-limite">Fecha L√≠mite</th>
          <th class="col-estatus">Estatus</th>
          <th class="col-verificacion">Siguiente Verificaci√≥n</th>
          <th class="col-observaciones">Observaciones (Opcional)</th>
        </tr>
      </thead>
      <tbody>
        @for (risk of risks; track $index; let i = $index) {
          <tr [class.row-even]="i % 2 === 0" [class.row-odd]="i % 2 !== 0">
            <!-- ID -->
            <td class="cell-id">{{ risk.id }}</td>
            
            <!-- Tipo -->
            <td>
              <select [(ngModel)]="risk.tipo" class="input-cell">
                <option value="">-</option>
                @for (tipo of tiposRiesgo; track tipo) {
                  <option [value]="tipo">{{ tipo }}</option>
                }
              </select>
            </td>
            
            <!-- ID del Proyecto -->
            <td>
              <input type="text" [(ngModel)]="risk.idProyecto" class="input-cell" placeholder="ID" />
            </td>
            
            <!-- Categor√≠a -->
            <td>
              <select [(ngModel)]="risk.categoria" class="input-cell">
                <option value="">-</option>
                @for (cat of categorias; track cat) {
                  <option [value]="cat">{{ cat }}</option>
                }
              </select>
            </td>
            
            <!-- Descripci√≥n del Riesgo -->
            <td>
              <input type="text" [(ngModel)]="risk.descripcion" class="input-cell input-wide" placeholder="Descripci√≥n..." />
            </td>
            
            <!-- Consecuencia -->
            <td>
              <input type="text" [(ngModel)]="risk.consecuencia" class="input-cell input-wide" placeholder="Consecuencia..." />
            </td>
            
            <!-- Identificado por -->
            <td>
              <input type="text" [(ngModel)]="risk.identificadoPor" class="input-cell" placeholder="Nombre" />
            </td>
            
            <!-- Fecha de Registro -->
            <td>
              <input type="date" [(ngModel)]="risk.fechaRegistro" class="input-cell input-date" />
            </td>
            
            <!-- Nivel de Impacto Total -->
            <td>
              <select [(ngModel)]="risk.nivelImpactoTotal" class="input-cell">
                <option value="">-</option>
                @for (nivel of nivelesImpacto; track nivel) {
                  <option [value]="nivel">{{ nivel }}</option>
                }
              </select>
            </td>
            
            <!-- Probabilidad de Ocurrencia -->
            <td>
              <select [(ngModel)]="risk.probabilidadOcurrencia" class="input-cell">
                <option value="">-</option>
                @for (prob of probabilidadesOcurrencia; track prob) {
                  <option [value]="prob">{{ prob }}</option>
                }
              </select>
            </td>
            
            <!-- Evaluaci√≥n de Riesgos -->
            <td>
              <input type="text" [(ngModel)]="risk.evaluacionRiesgo" class="input-cell" placeholder="Evaluaci√≥n" />
            </td>
            
            <!-- Estrategia del Riesgo -->
            <td>
              <select [(ngModel)]="risk.estrategiaRiesgo" class="input-cell">
                <option value="">-</option>
                @for (estrategia of estrategias; track estrategia) {
                  <option [value]="estrategia">{{ estrategia }}</option>
                }
              </select>
            </td>
            
            <!-- Respuesta al Riesgo -->
            <td>
              <select [(ngModel)]="risk.respuestaRiesgo" class="input-cell">
                <option value="">-</option>
                @for (respuesta of respuestasRiesgo; track respuesta) {
                  <option [value]="respuesta">{{ respuesta }}</option>
                }
              </select>
            </td>
            
            <!-- Responsable -->
            <td>
              <input type="text" [(ngModel)]="risk.responsable" class="input-cell" placeholder="Responsable" />
            </td>
            
            <!-- Fecha L√≠mite -->
            <td>
              <input type="date" [(ngModel)]="risk.fechaLimite" class="input-cell input-date" />
            </td>
            
            <!-- Estatus -->
            <td>
              <select [(ngModel)]="risk.estatus" class="input-cell">
                <option value="">-</option>
                @for (estatus of estatusOpciones; track estatus) {
                  <option [value]="estatus">{{ estatus }}</option>
                }
              </select>
            </td>
            
            <!-- Siguiente Verificaci√≥n -->
            <td>
              <input type="date" [(ngModel)]="risk.siguienteVerificacion" class="input-cell input-date" />
            </td>
            
            <!-- Observaciones (Opcional) -->
            <td>
              <textarea [(ngModel)]="risk.observaciones" class="input-cell input-wide" placeholder="Observaciones..." rows="2"></textarea>
            </td>
            
            <!-- Acciones -->
            <td class="cell-actions">
              <button class="btn-delete" (click)="deleteRisk(i)" title="Eliminar fila">üóëÔ∏è</button>
            </td>
          </tr>
        }
      </tbody>
    </table>
  </div>

  <!-- Footer Info -->
  <div class="footer-info">
    <p>Total de riesgos: <strong>{{ risks.length }}</strong></p>
  </div>
</div>
